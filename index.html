<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fortran-lapack: fortran-lapack</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">fortran-lapack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">fortran-lapack </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2fortran-lapack_2fortran-lapack_2_r_e_a_d_m_e"></a>This package provides precision-agnostic, high-level linear algebra APIs for <code>real</code> and <code>complex</code> arguments in Modern Fortran. The APIs are similar to NumPy/SciPy operations, and leverage a Modern Fortran implementation of the <a href="http://github.com/reference-LAPACK">Reference-LAPACK</a> library.</p>
<p>A full and standardized implementation of the present library has been integrated into the <a href="http://stdlib.fortran-lang.org/">Fortran Standard Library</a>, and as such, most users should seek to access the functionality from <code>stdlib</code>. The present library is kept in place for those who seek a compact implementation of it.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Current API</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
@ref la_solve::solve "`solve`" - Solves a linear matrix equation or a linear system of equations.</h2>
<h3><a class="anchor" id="autotoc_md7"></a>
Syntax</h3>
<p><code>x = solve(a, b [, overwrite_a] [, err])</code> <br  />
</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Description</h3>
<p>Solve linear systems - one (<code>b(:)</code>) or many (<code>b(:,:)</code>). <br  />
</p>
<h3><a class="anchor" id="autotoc_md9"></a>
Arguments</h3>
<ul>
<li><code>a</code>: A <code>real</code> or <code>complex</code> coefficient matrix. If <code>overwrite_a=.true.</code>, it is destroyed by the call.</li>
<li><code>b</code>: A rank-1 (one system) or rank-2 (many systems) array of the same kind as <code>a</code>, containing the right-hand-side vector(s).</li>
<li><code>overwrite_a</code> (optional, default = <code>.false.</code>): If <code>.true.</code>, input matrix <code>a</code> will be used as temporary storage and overwritten, to avoid internal data allocation.</li>
<li><code>err</code> (optional): A <a class="el" href="structla__state__type_1_1la__state.html">`type(la_state)`</a> variable.</li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
Return value</h3>
<p>For a full-rank matrix, returns an array value that represents the solution to the linear system of equations.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Errors</h3>
<ul>
<li>Raises <a class="el" href="namespacela__state__type.html#af5b55841ca3045c3345d9ab019e0797d">`LINALG_ERROR`</a> if the matrix is singular to working precision.</li>
<li>Raises <a class="el" href="namespacela__state__type.html#ad9888f2f7d4e692e7d3b8fd532baa903">`LINALG_VALUE_ERROR`</a> if the matrix and rhs vectors have invalid/incompatible sizes.</li>
<li>If <code>err</code> is not present, exceptions trigger an <code>error stop</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
&lt;tt&gt;lstsq(A, b)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Solve non-square systems in a least squares sense - one (<code>b(:)</code>) or many (<code>b(:,:)</code>). <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>cond</code>: Optional SVD cutoff. <br  />
</li>
<li><code>overwrite_a</code>: Option to let A be destroyed. <br  />
</li>
<li><code>rank</code>: Return matrix rank. <br  />
</li>
<li><code>err</code>: Return state handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
&lt;tt&gt;det(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Determinant of a scalar or square matrix. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>overwrite_a</code>: Option to let A be destroyed. <br  />
</li>
<li><code>err</code>: Return state handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md14"></a>
&lt;tt&gt;inv(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Inverse of a scalar or square matrix. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: Return state handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
&lt;tt&gt;pinv(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Moore-Penrose Pseudo-Inverse of a matrix. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>rtol</code>: Optional singular value threshold. <br  />
</li>
<li><code>err</code>: Return state handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
&lt;tt&gt;invert(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: In-place inverse of a scalar or square matrix. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: Return state handler. <br  />
</li>
</ul>
<p><b>Usage</b>: <code>call invert(A, err=err)</code> where <code>A</code> is replaced with $A^{-1}$.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
&lt;tt&gt;.inv.A&lt;/tt&gt;</h2>
<p><b>Type</b>: Operator <br  />
 <b>Description</b>: Inverse of a scalar or square matrix. <br  />
</p>
<p><b>Effect</b>: <code>A</code> is replaced with $A^{-1}$.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
&lt;tt&gt;.pinv.A&lt;/tt&gt;</h2>
<p><b>Type</b>: Operator <br  />
 <b>Description</b>: Moore-Penrose Pseudo-Inverse. <br  />
</p>
<p><b>Effect</b>: <code>A</code> is replaced with $A^{-1}$.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
&lt;tt&gt;svd(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: Singular value decomposition of $A = U S V^t$. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>s</code>: Singular values. <br  />
</li>
<li><code>u</code>: Left singular vectors. <br  />
</li>
<li><code>vt</code>: Right singular vectors. <br  />
</li>
<li><code>full_matrices</code>: Defaults to <code>.false.</code>. <br  />
</li>
<li><code>err</code>: State handler. <br  />
</li>
</ul>
<p><b>Usage</b>: <code>call svd(A, s, u, vt, full_matrices=.false., err=state)</code>.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
&lt;tt&gt;svdvals(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Singular values $S$ from $A = U S V^t$. <br  />
 <b>Usage</b>: <code>s = svdvals(A)</code> where <code>s</code> is a real array with the same precision as <code>A</code>.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
&lt;tt&gt;eye(m)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Identity matrix of size <code>m</code>. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>n</code>: Optional column size. <br  />
</li>
<li><code>mold</code>: Optional datatype (default: real64). <br  />
</li>
<li><code>err</code>: Error handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md22"></a>
&lt;tt&gt;eigvals(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Eigenvalues of matrix $A$. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: State handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
&lt;tt&gt;eig(A, lambda)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: Eigenproblem of matrix $A<code>. &lt;br&gt; **Optional arguments**: &lt;br&gt; -</code>left<code>: Output left eigenvector matrix. &lt;br&gt; -</code>right<code>: Output right eigenvector matrix. &lt;br&gt; -</code>overwrite_a<code>: Option to let A be destroyed. &lt;br&gt; -</code>err`: Return state handler.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
&lt;tt&gt;eigvalsh(A)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Eigenvalues of symmetric or Hermitian matrix $A$. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>upper_a</code>: Choose to use upper or lower triangle. <br  />
</li>
<li><code>err</code>: State handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md25"></a>
&lt;tt&gt;eigh(A, lambda)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: Eigenproblem of symmetric or Hermitian matrix $A<code>. &lt;br&gt; **Optional arguments**: &lt;br&gt; -</code>vector<code>: Output eigenvectors. &lt;br&gt; -</code>upper_a<code>: Choose to use upper or lower triangle. &lt;br&gt; -</code>overwrite_a<code>: Option to let A be destroyed. &lt;br&gt; -</code>err`: Return state handler.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
&lt;tt&gt;diag(n, source)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Diagonal matrix from scalar input value. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: Error handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
&lt;tt&gt;diag(source)&lt;/tt&gt;</h2>
<p><b>Type</b>: Function <br  />
 <b>Description</b>: Diagonal matrix from array input values. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: Error handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
&lt;tt&gt;qr(A, Q, R)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: QR factorization. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>storage</code>: Pre-allocated working storage. <br  />
</li>
<li><code>err</code>: Error handler.</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
&lt;tt&gt;qr_space(A, lwork)&lt;/tt&gt;</h2>
<p><b>Type</b>: Subroutine <br  />
 <b>Description</b>: QR Working space size. <br  />
 <b>Optional arguments</b>: <br  />
</p><ul>
<li><code>err</code>: Error handler.</li>
</ul>
<p>All procedures work with all types (<code>real</code>, <code>complex</code>) and kinds (32, 64, 128-bit floats).</p>
<h1><a class="anchor" id="autotoc_md30"></a>
BLAS, LAPACK</h1>
<p>Modern Fortran modules with full explicit typing features are available as modules <code><a class="el" href="namespacela__blas.html" title="Precision-agnostic BLAS interface.">la_blas</a></code> and <code><a class="el" href="namespacela__lapack.html" title="Precision-agnostic LAPACK interface.">la_lapack</a></code>. The reference Fortran-77 library, forked from Release 3.10.1, was automatically processed and modernized. The following refactorings are applied:</p><ul>
<li>All datatypes and accuracy constants standardized into a module (<code>stdlib</code>-compatible names)</li>
<li>Both libraries available for 32, 64 and 128-bit floats</li>
<li>Free format, lower-case style</li>
<li><code>implicit none(type, external)</code> everywhere</li>
<li>all <code>pure</code> procedures where possible</li>
<li><code>intent</code> added to all procedure arguments</li>
<li>Removed <code>DO 10 .... 10 CONTINUE</code>, replaced with <code>do..end do</code> loops or labelled <code>loop_10: do ... cycle loop_10 ... end do loop_10</code> in case control statements are present</li>
<li>BLAS modularized into a single-file module</li>
<li>LAPACK modularized into a single-file module</li>
<li>All procedures prefixed (with <code>stdlib_</code>, currently).</li>
<li>F77-style <code>parameter</code>s removed, and numeric constants moved to the top of each module.</li>
<li>Ambiguity in single vs. double precision constants (<code>0.0</code>, <code>0.d0</code>, <code>(1.0,0.0)</code>) removed</li>
<li>preprocessor-based OpenMP directives retained.</li>
</ul>
<p>The single-source module structure hopefully allows for cross-procedural inlining which is otherwise impossible without link-time optimization.</p>
<h1><a class="anchor" id="autotoc_md31"></a>
Building</h1>
<p>An automated build is currently available via the <a href="https://fpm.fortran-lang.org">Fortran Package Manager</a>. To add fortran-lapack to your project, simply add it as a dependency:</p>
<div class="fragment"><div class="line">[dependencies]</div>
<div class="line">fortran-lapack = { git=&quot;https://github.com/perazz/fortran-lapack.git&quot; }</div>
</div><!-- fragment --><p><code>fortran-lapack</code> is compatible with the LAPACK API. If high-performance external BLAS/LAPACK libraries are available, it is sufficient to define macros</p>
<div class="fragment"><div class="line">[dependencies]</div>
<div class="line">fortran-lapack = { git=&quot;https://github.com/perazz/fortran-lapack.git&quot;, preprocess.cpp.macros=[&quot;LA_EXTERNAL_BLAS&quot;, &quot;LA_EXTERNAL_LAPACK&quot;] }</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md32"></a>
Extension to external BLAS/LAPACK libraries</h1>
<p>Generic interfaces to most BLAS/LAPACK functions are exposed to modules <code><a class="el" href="namespacela__blas.html" title="Precision-agnostic BLAS interface.">la_blas</a></code> and <code><a class="el" href="namespacela__lapack.html" title="Precision-agnostic LAPACK interface.">la_lapack</a></code>. These interfaces drop the initial letter to wrap a precision-agnostic version. For example, <code>axpy</code> is a precision-agnostic interface to <code>saxpy</code>, <code>daxpy</code>, <code>caxpy</code>, <code>zaxpy</code>, <code>qaxpy</code>, <code>waxpy</code>. The naming convention is:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">32-bit   </th><th class="markdownTableHeadNone">64-bit   </th><th class="markdownTableHeadNone">128-bit    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">real   </td><td class="markdownTableBodyNone"><code>s</code>   </td><td class="markdownTableBodyNone"><code>d</code>   </td><td class="markdownTableBodyNone"><code>q</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">complex   </td><td class="markdownTableBodyNone"><code>c</code>   </td><td class="markdownTableBodyNone"><code>z</code>   </td><td class="markdownTableBodyNone"><code>w</code>   </td></tr>
</table>
<p>All public interfaces in <code><a class="el" href="namespacela__blas.html" title="Precision-agnostic BLAS interface.">la_blas</a></code> and <code><a class="el" href="namespacela__lapack.html" title="Precision-agnostic LAPACK interface.">la_lapack</a></code> allow seamless linking against external libraries via a simple pre-processor flag. When an external library is available, just define macros <code>LA_EXTERNAL_BLAS</code> and <code>LA_EXTERNAL_LAPACK</code>. The kind-agnostic interface will just point to the external function. All such interfaces follow this template: <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">interface</span> axpy</div>
<div class="line"><span class="preprocessor">#ifdef LA_EXTERNAL_BLAS</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">! Use external library</span></div>
<div class="line">    <span class="keywordtype">pure</span> <span class="keyword">subroutine </span>saxpy(n, a, x, incx, y, incy)</div>
<div class="line">      <span class="keywordtype">import </span>:: ik, sp</div>
<div class="line">      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: wp = sp</div>
<div class="line">      <span class="keywordtype">integer(ik)</span>, <span class="keywordtype">intent(in)</span> :: n</div>
<div class="line"><span class="keywordtype">      real</span>(wp), <span class="keywordtype">intent(in)</span> :: a</div>
<div class="line"><span class="keywordtype">      real</span>(wp), <span class="keywordtype">intent(in)</span> :: x(*)</div>
<div class="line">      <span class="keywordtype">integer(ik)</span>, <span class="keywordtype">intent(in)</span> :: incx</div>
<div class="line"><span class="keywordtype">      real</span>(wp), <span class="keywordtype">intent(inout)</span> :: y(*)</div>
<div class="line">      <span class="keywordtype">integer(ik)</span>, <span class="keywordtype">intent(in)</span> :: incy</div>
<div class="line">    <span class="keyword">end subroutine </span>saxpy</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">! Use internal implementation</span></div>
<div class="line">    <span class="keyword">module procedure</span> la_saxpy</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="keyword">end interface</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md33"></a>
Licensing</h1>
<p>LAPACK is a freely-available software package. It is available from <a href="https://www.netlib.org/lapack/">netlib</a> via anonymous ftp and the World Wide Web. Thus, it can be included in commercial software packages (and has been). Credit for the library should be given to the <a href="https://www.netlib.org/lapack/contributor-list.html">LAPACK authors</a>. The license used for the software is the <a href="https://www.netlib.org/lapack/LICENSE.txt">modified BSD license</a>. According to the original license, we changed the name of the routines and commented the changes made to the original.</p>
<h1><a class="anchor" id="autotoc_md34"></a>
Acknowledgments</h1>
<p>Part of this work was supported by the <a href="https://www.sovereigntechfund.de">Sovereign Tech Fund</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jan 31 2025 10:05:01 for fortran-lapack by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
